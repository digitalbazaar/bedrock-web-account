<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: AccountService.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: AccountService.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*!
 * Copyright (c) 2018 Digital Bazaar, Inc. All rights reserved.
 */
'use strict';

import axios from 'axios';

export class AccountService {
  constructor({
    urls = {
      base: '/accounts'
    }
  } = {}) {
    this.config = {urls};
  }

  async exists({url = this.config.urls.base, email}) {
    try {
      await axios.get(url, {
        params: {
          exists: true,
          email
        }
      });
      return true;
    } catch(e) {}
    return false;
  }

  async create({url = this.config.urls.base, email}) {
    const response = await axios.post(url, {email}, {
      headers: {'Accept': 'application/ld+json, application/json'}
    });
    return response.data;
  }

  async get({url = this.config.urls.base, id}) {
    const response = await axios.get(url + '/' + id, {
      headers: {'Accept': 'application/ld+json, application/json'}
    });
    return response.data;
  }

  /**
   * @method accounts
   * @param {Object} config
   * @param {string} config.url - the base url
   * @param {string} config.email - the user's email
   * @param {string} config.after - an account's DID
   * @param {integer} config.limit - how many accounts to return
   * @return {Array} data
   * @description calls on the index route and returns all
   * accounts that match the email passed in.
   */
  async accounts({url = this.config.urls.base, email, after, limit}) {
    const response = await axios.get(url, {
      params: {email, after, limit},
      headers: {'Accept': 'application/ld+json, application/json'}});
    return response.data;
  }

  /**
   * @method update
   * @param {Object} config
   * @param {string} config.url
   * @param {string} config.id - an account's id
   * @param {integer} config.sequence - an account's sequence number
   * @param {Array&lt;Object>} config.patch - an array of json patches
   * @return {Void}
   * @description updates an account via a series of json patches
   * patches need to be in the:
   * [json patch format]{@link https://tools.ietf.org/html/rfc6902}
   * [we use fast-json]{@link https://www.npmjs.com/package/fast-json-patch}
   * for handling json patches.
   */
  async update({url = this.config.urls.base, id, sequence, patch}) {
    await axios.patch(`${url}/${id}`,
      {sequence, patch},
      {headers: {'Accept': 'application/ld+json, application/json'}});
  }

  /**
   * @method setStatus
   * @param {Object} config
   * @param {string} config.url
   * @param {string} config.id - an account id
   * @param {string} config.status - a string that is either active or deleted
   * @return {Void}
   * @description taken an id and a status string changes an account's status
  */
  async setStatus({url = this.config.urls.base, id, status}) {
    await axios.post(`${url}/${id}/status`,
      {status},
      {headers: {'Accept': 'application/ld+json, application/json'}});
  }
  /**
   * @method getCaps
   * @param {Object} config
   * @param {string} config.url
   * @param {string} config.id - an account id
   * @return {Void}
   * @description takes an id and returns all sysRoles for it.
  */
  async getCaps({url = this.config.urls.base, id}) {
    const response = await axios.get(`${url}/${id}/roles`,
      {headers: {'Accept': 'application/ld+json, application/json'}});
    return response.data;
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#accounts">accounts</a></li><li><a href="global.html#getCaps">getCaps</a></li><li><a href="global.html#setStatus">setStatus</a></li><li><a href="global.html#update">update</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Feb 12 2019 11:39:52 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
